<div class="modal-wrapper">
    <div class="modal-content">
        <h2 class="page-header"><i class="ss-icon">&#x1F464;</i>Add User
            <span class="actions"><i class="ss-icon">&#x2421;</i></span>
        </h2>
            <div class="spacer"><!--ZXP--></div>
        <div class="widget-add-user-option">
            <div class="lower-content">
            <p class="description">You can either import users via a CSV file or manually add them.
            If you are using LDAP for user management, users will be added automatically.</p>

        {% if not features.ldap %}
            <div class="option-box" id="option-upload-csv">
                <p>Upload from<br />a CSV file.</p>
                <button class="button button-primary-basic">Upload CSV</button>
            </div>
        {% endif %}
            <div class="option-box" id="option-add-user">
                <p>Manually<br />add users.</p>
                <button class="button button-primary-basic">Create User</button>
            </div>
            </div>
        </div>

{% if config.enable_local_users %}
        <div class="widget-add-user" style="display:none">
            <form action="{% url 'blue_mgnt:users' %}" enctype="multipart/form-data" method="POST">
            {% csrf_token %}
            <input type="hidden" name="form" value="new_user">
            <table class="widget-table">
            {% for field in new_user.visible_fields %}
                <tr>
                    <td class="modal-table-label">
                        {{ field.label_tag }}
                    </td>
                    <td>
                        {{ field }}
                    </td>
                    {% if field.errors %}
                        <br />
                        <span class="errors">
                        {% for error in field.errors %}
                            {{ error }}
                        {% endfor %}
                        </span>
                    </td>
                    {% else %}
                    </td>
                    {% endif %}
                </tr>
            {% endfor %}
            <tr>
                <td colspan="2"></td>
            </tr>
        </table>
            <div class="widget-actions">
                <input type="submit" value="Create User" class="rhs button button-primary-basic">
                <input type='hidden' value='new_user' name='form'>
                {% for hidden in new_user.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
            </div>
        </form>
    </div>
{% endif %}
{% if not features.ldap %}
<div class="widget-add-user" style="display: none">
    <form action="{% url 'blue_mgnt:users' %}" enctype="multipart/form-data" method="post">
    {% csrf_token %}
        <fieldset>
            {% for field in user_csv %}
            <table class="widget-table">
                <tr>
                    <td class="modal-table-label">
                        {{ field.label_tag }}
                    </td>
                    <td>
                        {{ field }}
                        {% if field.errors %}
                        <br />
                        <span class="errors">
                            {% for error in field.errors %}
                                {{ error }}
                            {% endfor %}
                        </span>
                    </td>
                        {% else %}
                        <label for="id_{{ field.name }}">
                        </label>
                    </td>
                        {% endif %}
                    
            {% endfor %}
            </table>
        </fieldset>
        <div class="widget-actions">
            <input type='submit' value="Upload CSV" class="rhs button button-primary-basic">
            <input type='hidden' value='csv' name='form'>
        </div>
    </form>
</div>
{% endif %}
    </div>
</div>
